[gcode_macro start_print]
gcode:
  G90 # use absolute coordinates
  M83 # extruder relative mode
  M140 S{params.BED_TEMP} ; set final bed temp
  M104 S{params.NOZZLE_TEMP} ; set final nozzle temp
  {% if printer.toolhead.homed_axes|length < 3 %}
    G28 ; home all axes
  {% endif %}
  G1 Z50 F240
  G1 X5 Y10 F3000
  M190 S{params.BED_TEMP} ; wait for bed temp to stabilize
  M109 S{params.NOZZLE_TEMP} ; wait for nozzle temp to stabilize
  G1 Z0.28 F240
  G92 E0
  G1 Y140 E10 F1500 ; prime the nozzle
  G1 X5.3 F5000
  G92 E0
  G1 Y10 E10 F1200 ; prime the nozzle
  G92 E0
