[include ../../delayed_gcodes/clear_display.cfg]

[gcode_macro CANCEL_PRINT]
rename_existing: BASE_CANCEL_PRINT
gcode:
    CLEAR_PAUSE
    SDCARD_RESET_FILE
    BASE_CANCEL_PRINT
    SET_SKEW CLEAR=1
    {% if params.KEEP_HEATING|default(true) == False %}
        M117 Turning off heaters
        TURN_OFF_HEATERS
    {% endif %}
    M107 # Turn off the part fan
    M117 Moving bed forward
    G1 Y{printer.toolhead.axis_maximum.y} F{printer.configfile.settings.stepper_y.homing_speed * 60}
    UPDATE_DELAYED_GCODE ID=clear_display DURATION=10